"use strict";var state={user:"",list:""};function httpGetAsync(e){var i=this;return new Promise(function(t,n){var s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=function(){var e=s.responseText;200==s.status?t(e):n({status:i.status,statusText:xhr.statusText})},s.onerror=function(){n({status:i.status,statusText:xhr.statusText})},s.send(null)})}function httpPostAsync(e,i){var o=this;return new Promise(function(t,n){var s=new XMLHttpRequest;s.open("POST",e,!0),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){if(200==s.status){var e=s.responseText;t(e)}else n({status:o.status,statusText:xhr.statusText})},s.onerror=function(){n({status:o.status,statusText:xhr.statusText})},s.send(JSON.stringify(i))})}var updateUserPlaylistsView=function o(e){httpGetAsync("/playlists?user="+state.user).then(function(e){if("try again"!==e){var t=[];e=JSON.parse(e).items;for(var n=0;n<e.length;n++){var s=e[n],i=n%2==0?"odd":"even";t.push('<p class="playlist playlist--'+i+'">\n                    <span class="playlist__pointer playlist__pointer--'+i+'"></span>\n                    <a class="playlist__link playlist__link--'+i+'" href="/songs?user='+state.user+"&list="+s.id+'" >\n                      <span>\n                        '+s.name+"\n                      </span>\n                    </a>\n                  </p>\n                ")}updateMainView(t.join(""))}else o()},function(e){console.log(e)})},redirectToListView=function(){var e=document.getElementById("username").value;window.location.href="/lists?user="+e},checkForEnter=function(e){13==e.keyCode&&redirectToListView()},updateInitialView=function(){document.querySelector(".header-img").src="/images/personalist-white.png",document.querySelector(".header-img-container").classList.add("header-img-container--home"),document.querySelector(".header-img").classList.add("header-img--home"),updateMainView('\n      <div class="btn-container">\n          <input onkeypress="checkForEnter(event)" type="text" name="username" id="username" placeholder="Enter your Spotify username">\n          <button class="btn" onclick="redirectToListView()" >\n            Go!\n          </button>\n      </div>\n    <div class="bands">\n      <p></p>\n      <p></p>\n      <p></p>\n    </div>\n  ')},updatePlaylistSongsView=function(){httpGetAsync("/playlist?user="+state.user+"&list="+state.list).then(function(e){var t=[];e=JSON.parse(e);var n=!0,s=!1,i=void 0;try{for(var o,a=e.items[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var r=o.value,l="";r.messinaId,r.description;0<r.description.length&&(l="has-description"),t.push('\n      <div class="song-item song-item--'+r.id+" "+l+'">\n        <p onclick="toggleDescription(event, \''+r.id+'\')" class="song-item__name song-item__name--'+r.id+' clickable">\n          <span>\n            '+r.name+'\n          </span>\n          <span id="play-icon--'+r.id+'" class="song-item__name__play" onclick="playSong(\''+r.id+'\')">\n            <svg id="play-icon-'+r.id+'" class="feather feather-play sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-reactid="916"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>\n          </span>\n        </p>\n        <div class="song-item__description song-item__description--'+r.id+'">\n          <textarea type="text"\n                    placeholder="Description"\n                    name="song-'+r.messinaId+'"\n                    id="song-'+r.messinaId+'">'+r.description+'</textarea>\n          <div class="song-item__description__btn-container">\n            <button id="save-btn-'+r.messinaId+'" class="save-btn clickable" onclick="setPlaylistSongs(\''+r.messinaId+'\')">Save</button>\n            <button id="cancel-btn-'+r.messinaId+'" class="cancel-btn clickable" onclick="toggleDescription(event, \''+r.id+"')\">Cancel</button>\n          </div>\n        </div>\n      </div>\n      ")}}catch(e){s=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(s)throw i}}t.push('<div id="embed-player"></div>'),updateMainView(t.join(""))})},setPlaylistSongs=function(e){document.getElementById("save-btn-"+e),document.getElementById("cancel-btn-"+e);httpPostAsync("/playlist",[{id:e,description:document.getElementById("song-"+e).value}]).then(function(e){var t=document.querySelector(".save-confirmation");t.classList.add("save-confirmation--on"),setTimeout(function(){t.classList.remove("save-confirmation--on")},3e3)})},updateMainView=function(e){document.querySelectorAll("main#main")[0].innerHTML=e},toggleDescription=function(e,t){if(!e.target.closest(".song-item__name__play")){var n=document.querySelectorAll(".song-item--"+t)[0];n.classList.contains("song-item--shown")?(n.classList.add("song-item--hidden"),n.classList.remove("song-item--shown")):(n.classList.add("song-item--shown"),n.classList.remove("song-item--hidden"))}},playSong=function(e){document.querySelectorAll("#embed-player")[0].innerHTML='<iframe src="https://open.spotify.com/embed/track/'+e+'" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>',document.querySelectorAll("#play-icon--"+e)[0].style.opacity=0,document.querySelectorAll("#play-icon--"+e)[0].onclick=function(){return pauseSong(e)},document.querySelectorAll("#play-icon--"+e)[0].classList.add("play-icon--playing"),setTimeout(function(){document.querySelectorAll("#play-icon--"+e)[0].innerHTML='\n<svg id="pause-icon-'+e+'" class="feather feather-x sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-reactid="1336"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>\n  ',document.querySelectorAll("#play-icon--"+e)[0].onclick=function(){return pauseSong(e)},document.querySelectorAll("#play-icon--"+e)[0].style.opacity=1},500)},pauseSong=function(e){document.querySelectorAll("#embed-player")[0].innerHTML="",document.querySelectorAll("#play-icon--"+e)[0].style.opacity=0,document.querySelectorAll("#play-icon--"+e)[0].classList.remove("play-icon--playing"),setTimeout(function(){document.querySelectorAll("#play-icon--"+e)[0].innerHTML='\n            <svg id="play-icon-'+e+'" class="feather feather-play sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-reactid="916"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>\n  ',document.querySelectorAll("#play-icon--"+e)[0].onclick=function(){return playSong(e)},document.querySelectorAll("#play-icon--"+e)[0].style.opacity=1},500)};function findGetParameter(t){var n=null,s=[];return location.search.substr(1).split("&").forEach(function(e){(s=e.split("="))[0]===t&&(n=decodeURIComponent(s[1]))}),n}!function(){switch(window.location.pathname){case"/":document.querySelectorAll("body")[0].id="home",updateInitialView();break;case"/lists":document.querySelectorAll("body")[0].id="lists",state.user=findGetParameter("user"),updateUserPlaylistsView();break;case"/songs":document.querySelectorAll("body")[0].id="songs",state.user=findGetParameter("user"),state.list=findGetParameter("list"),updatePlaylistSongsView()}}();
//# sourceMappingURL=main.min.js.map
