"use strict";var state={user:"",list:""};function httpGetAsync(e){var s=this;return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){var e=o.responseText;200==o.status?t(e):n({status:s.status,statusText:xhr.statusText})},o.onerror=function(){n({status:s.status,statusText:xhr.statusText})},o.send(null)})}function httpPostAsync(e,s){var a=this;return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/json"),o.onload=function(){if(200==o.status){var e=o.responseText;t(e)}else n({status:a.status,statusText:xhr.statusText})},o.onerror=function(){n({status:a.status,statusText:xhr.statusText})},o.send(JSON.stringify(s))})}var updateUserPlaylistsView=function(e){httpGetAsync("/playlists?user=".concat(state.user)).then(function(e){var t=[];e=JSON.parse(e).items;for(var n=0;n<e.length;n++){var o=e[n],s=n%2==0?"odd":"even";t.push('<p class="playlist playlist--'.concat(s,'">\n                    <span class="playlist__pointer playlist__pointer--').concat(s,'"></span>\n                    <a class="playlist__link playlist__link--').concat(s,'" href="/songs?user=').concat(state.user,"&list=").concat(o.id,'" >\n                      <span>\n                        ').concat(o.name,"\n                      </span>\n                    </a>\n                  </p>\n                "))}updateMainView(t.join(""))},function(e){console.log(e)})},redirectToListView=function(){var e=document.getElementById("username").value;window.location.href="/lists?user=".concat(e)},checkForEnter=function(e){13==e.keyCode&&redirectToListView()},updateInitialView=function(){document.querySelector(".header-img").src="/images/personalist-white.png",document.querySelector(".header-img-container").classList.add("header-img-container--home"),document.querySelector(".header-img").classList.add("header-img--home"),updateMainView('\n      <div class="btn-container">\n          <input onkeypress="checkForEnter(event)" type="text" name="username" id="username" placeholder="Enter your Spotify username">\n          <button class="btn" onclick="redirectToListView()" >\n            Go!\n          </button>\n      </div>\n    <div class="bands">\n      <p></p>\n      <p></p>\n      <p></p>\n    </div>\n  ')},updatePlaylistSongsView=function(){httpGetAsync("/playlist?user=".concat(state.user,"&list=").concat(state.list)).then(function(e){var t=[];e=JSON.parse(e);var n=!0,o=!1,s=void 0;try{for(var a,i=e.items[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value,r="";c.messinaId,c.description;0<c.description.length&&(r="has-description"),t.push('\n      <div class="song-item song-item--'.concat(c.id," ").concat(r,'">\n        <p onclick="toggleDescription(event, \'').concat(c.id,'\')" class="song-item__name song-item__name--').concat(c.id,' clickable">\n          <span>\n            ').concat(c.name,'\n          </span>\n          <span id="play-icon--').concat(c.id,'" class="song-item__name__play" onclick="playSong(\'').concat(c.id,'\')">\n            <svg id="play-icon-').concat(c.id,'" class="feather feather-play sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-reactid="916"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>\n          </span>\n        </p>\n        <div class="song-item__description song-item__description--').concat(c.id,'">\n          <textarea type="text"\n                    placeholder="Description"\n                    name="song-').concat(c.messinaId,'"\n                    id="song-').concat(c.messinaId,'">').concat(c.description,'</textarea>\n          <div class="song-item__description__btn-container">\n            <button id="save-btn-').concat(c.messinaId,'" class="save-btn clickable" onclick="setPlaylistSongs(\'').concat(c.messinaId,'\')">Save</button>\n            <button id="cancel-btn-').concat(c.messinaId,'" class="cancel-btn clickable" onclick="toggleDescription(event, \'').concat(c.id,"')\">Cancel</button>\n          </div>\n        </div>\n      </div>\n      "))}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}t.push('<div id="embed-player"></div>'),updateMainView(t.join(""))})},setPlaylistSongs=function(e){document.getElementById("save-btn-".concat(e)),document.getElementById("cancel-btn-".concat(e));httpPostAsync("/playlist",[{id:e,description:document.getElementById("song-".concat(e)).value}]).then(function(e){var t=document.querySelector(".save-confirmation");t.classList.add("save-confirmation--on"),setTimeout(function(){t.classList.remove("save-confirmation--on")},3e3)})},updateMainView=function(e){document.querySelectorAll("main#main")[0].innerHTML=e},toggleDescription=function(e,t){if(!e.target.closest(".song-item__name__play")){var n=document.querySelectorAll(".song-item--".concat(t))[0];n.classList.contains("song-item--shown")?(n.classList.add("song-item--hidden"),n.classList.remove("song-item--shown")):(n.classList.add("song-item--shown"),n.classList.remove("song-item--hidden"))}},playSong=function(e){document.querySelectorAll("#embed-player")[0].innerHTML='<iframe src="https://open.spotify.com/embed/track/'.concat(e,'" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>'),document.querySelectorAll("#play-icon--".concat(e))[0].style.opacity=0,document.querySelectorAll("#play-icon--".concat(e))[0].onclick=function(){return pauseSong(e)},document.querySelectorAll("#play-icon--".concat(e))[0].classList.add("play-icon--playing"),setTimeout(function(){document.querySelectorAll("#play-icon--".concat(e))[0].innerHTML='\n<svg id="pause-icon-'.concat(e,'" class="feather feather-x sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-reactid="1336"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>\n  '),document.querySelectorAll("#play-icon--".concat(e))[0].onclick=function(){return pauseSong(e)},document.querySelectorAll("#play-icon--".concat(e))[0].style.opacity=1},500)},pauseSong=function(e){document.querySelectorAll("#embed-player")[0].innerHTML="",document.querySelectorAll("#play-icon--".concat(e))[0].style.opacity=0,document.querySelectorAll("#play-icon--".concat(e))[0].classList.remove("play-icon--playing"),setTimeout(function(){document.querySelectorAll("#play-icon--".concat(e))[0].innerHTML='\n            <svg id="play-icon-'.concat(e,'" class="feather feather-play sc-dnqmqq jxshSx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" data-reactid="916"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>\n  '),document.querySelectorAll("#play-icon--".concat(e))[0].onclick=function(){return playSong(e)},document.querySelectorAll("#play-icon--".concat(e))[0].style.opacity=1},500)};function findGetParameter(t){var n=null,o=[];return location.search.substr(1).split("&").forEach(function(e){(o=e.split("="))[0]===t&&(n=decodeURIComponent(o[1]))}),n}!function(){switch(window.location.pathname){case"/":document.querySelectorAll("body")[0].id="home",updateInitialView();break;case"/lists":document.querySelectorAll("body")[0].id="lists",state.user=findGetParameter("user"),updateUserPlaylistsView();break;case"/songs":document.querySelectorAll("body")[0].id="songs",state.user=findGetParameter("user"),state.list=findGetParameter("list"),updatePlaylistSongsView()}}();
//# sourceMappingURL=main.min.js.map
